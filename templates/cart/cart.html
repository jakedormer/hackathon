{% extends "base.html" %}
{% load static %}
{% load mathfilters %}

{% block css %}
<link rel="stylesheet" href="{% static 'cart/css/cart.css' %}" crossorigin="anonymous">
{% endblock %}

{% block body %}

  <!--Grid row-->
  <div class="row">
    {% if request.session.cart.items_in_cart == 0 %}
    <div class="col mt-5 text-center">
      <h1>Your cart is empty</h1>
      <i class="fas fa-4x fa-shopping-bag text-dark"></i>
      <p class="mt-4">Take a look around our shop!</p>
    </div>
    {% else %}
    <h2 class="my-3 text-center w-100">Cart: {{request.session.cart.items_in_cart}} items</h2>
    <div class="col-lg-8">

      <!-- Cart Item -->
      {% for product in products %}
      {% ifchanged %}
      <h3 class="mt-3"><span class="text-muted h5">Sold By</span> <b>{{product.vendor.display_name}}</b></h3>
      <hr class="">
      {% endifchanged %}
      <div class="row">
        <div class="col-3">
          <a href="{% if product.parent %}{{product.parent.slug}}/p/{{product.parent.id}} {% else %} {{product.slug}}/p/{{product.id}} {% endif %}">
          <img class="img-fluid img-thumbnail cart-img" src="{{product.image_src}}" alt="{{product.title}}" style="width:100px">
          </a>
        </div>
        <div class="col-5">
          <p class="font-weight-bold">{{product.title|title}}</p>
          <p>Size: <b><u>{{product.size}}</u></b></p>
          <p>Price: £{{product.stockrecords.first.price_inc_tax}}</p>
          <p>SubTotal: <b><u>£{{product.stockrecords.first.price_inc_tax|mul:2}}</u></b></p>
        </div>
        <div class="col-4 text-center">
          <p class="font-weight-bold">Quantity</p>
          {% for item in request.session.cart.products %}
          {% if item.id|add:"0" == product.id %}
          <p class="font-weight-bold">{{item.quantity}}</p>
          {% endif %}
          {% endfor %}

<!--           <form>
            <div class="form-group">
                <select class="form-control text-center" id="update" disabled>
                  {% for item in request.session.cart.products %}
                  {% if item.id|add:"0" == product.id %}
                  <option class="text-center">{{item.quantity}}</option>
                  {% endif %}
                  {% endfor %}
                </select>
              </div>
          </form> -->

          <form action="/remove_from_cart" method="get">
            <input type="hidden" name="product_id" value="{{product.id}}">
            <button type="submit" class="btn btn-outline-danger btn-sm">Remove</button>
          </form>
        </div>
      </div>
      <hr>
    {% endfor %}
  </div>

  <div class="col-lg-4">

    <div class="bg-light">
    <h5 class="my-3 pt-3 pl-3 font-weight-bold">Total</h5>
    <hr>

    <ul class="list-group list-group-flush">
      <li class="list-group-item bg-light d-flex justify-content-between font-weight-bold align-items-center border-0">
        Sub Total
        <span></span>
      </li>
      <li class="list-group-item bg-light d-flex justify-content-between align-items-center">
        Shipping
        <span></span>
      </li>
<!--       <li class="list-group-item d-flex justify-content-between align-items-center border-0 px-0 mb-3">
        <div>
          <strong>The total amount of</strong>
          <strong>
            <p class="mb-0">(including VAT)</p>
          </strong>
        </div>
        <span><strong>£XX.XX</strong></span>
      </li> -->
    </ul>
    <div class="text-center">
    <button type="button" class="btn btn-success w-95"><i class="fas fa-lock mr-2"></i><b>Checkout</b></button>
    </div>

    <div class="text-center my-4 text-dark">
      <i class="fab fa-cc-visa fa-2x mr-2"></i>
      <i class="fab fa-cc-mastercard fa-2x mr-2"></i>
      <i class="fab fa-stripe fa-2x"></i>
    </div>

  </div>
</div>

{% endif %}



</div>


{% endblock %}